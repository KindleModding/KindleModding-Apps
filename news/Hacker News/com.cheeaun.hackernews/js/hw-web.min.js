!function(t){function e(){}function n(){var e=location.hash.slice(1),t=!1,n=p.current,e=e||f.defaultPath;n&&n!=p.previous&&(p.previous=n),p.current=e;for(var o=0,r=u.length;o<r&&!t;o++){var i,s=u[o],a=s.path,l=s.name,c=s.fn;"string"==typeof a?a.toLowerCase()==e.toLowerCase()&&(f.before.call(p,a,l),c.call(p),f.on.call(p,a,l),t=!0):(i=e.match(a))&&(f.before.call(p,a,l,i),c.apply(p,i),f.on.call(p,a,l,i),t=!0)}return t||f.notfound.call(p),p}var u=[],f={defaultPath:"/",before:e,on:e,notfound:e},p={
current:null,previous:null,config:function(e){for(var t in e)e.hasOwnProperty(t)&&(f[t]=e[t]);return p},add:function(e,t,n){return e&&t&&("function"==typeof t&&(n=t,t=null),u.push({path:e,name:t,fn:n||function(){}})),p},go:function(e){return location.hash=e,p},back:function(e){return p.previous?(history.back(),p.previous=null):e&&(location.hash=e),p}};p.init=function(e){return t.addEventListener("hashchange",n),n()},p.reload=n,t.ruto=p}(window),function(e,p){var d=e.store=function(e,t,n){
var o=d.type;return n&&n.type&&n.type in d.types&&(o=n.type),d.types[o](e,t,n||{})};d.types={},d.type=null,d.addType=function(o,e){d.type||(d.type=o),d.types[o]=e,d[o]=function(e,t,n){return(n=n||{}).type=o,d(e,t,n)}},d.error=function(){return"amplify.store quota exceeded"};var o,r,f=/^__amplify__/;function t(c,u){d.addType(c,function(t,e,n){var o,r,i,s,a=e,l=(new Date).getTime();if(!t){a={},s=[],i=0;try{for(t=u.length;t=u.key(i++);)f.test(t)&&((r=JSON.parse(u.getItem(t))
).expires&&r.expires<=l?s.push(t):a[t.replace(f,"")]=r.data);for(;t=s.pop();)u.removeItem(t)}catch(e){}return a}if(t="__amplify__"+t,e===p){if(!((r=(o=u.getItem(t))?JSON.parse(o):{expires:-1}).expires&&r.expires<=l))return r.data;u.removeItem(t)}else if(null===e)u.removeItem(t);else{r=JSON.stringify({data:e,expires:n.expires?l+n.expires:null});try{u.setItem(t,r)}catch(e){d[c]();try{u.setItem(t,r)}catch(e){throw d.error()}}}return a})}for(var n in{localStorage:1,sessionStorage:1})try{
window[n].setItem("__amplify__","x"),window[n].removeItem("__amplify__"),t(n,window[n])}catch(e){}if(!d.types.localStorage&&window.globalStorage)try{t("globalStorage",window.globalStorage[window.location.hostname]),"sessionStorage"===d.type&&(d.type="globalStorage")}catch(e){}function i(e){return e===p?p:JSON.parse(JSON.stringify(e))}!function(){if(!d.types.localStorage){var u=document.createElement("div"),f="amplify";u.style.display="none",document.getElementsByTagName("head")[0].appendChild(u)
;try{u.addBehavior("#default#userdata"),u.load(f)}catch(e){return u.parentNode.removeChild(u)}d.addType("userData",function(t,e,n){u.load(f);var o,r,i,s,a,l=e,c=(new Date).getTime();if(!t){for(l={},a=[],s=0;o=u.XMLDocument.documentElement.attributes[s++];)(r=JSON.parse(o.value)).expires&&r.expires<=c?a.push(o.name):l[o.name]=r.data;for(;t=a.pop();)u.removeAttribute(t);return u.save(f),l}if(t=(t=t.replace(
/[^\-._0-9A-Za-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c-\u200d\u203f\u2040\u2070-\u218f]/g,"-")).replace(/^-/,"_-"),e===p){if(!((r=(o=u.getAttribute(t))?JSON.parse(o):{expires:-1}).expires&&r.expires<=c))return r.data;u.removeAttribute(t)}else null===e?u.removeAttribute(t):(i=u.getAttribute(t),r=JSON.stringify({data:e,expires:n.expires?c+n.expires:null}),u.setAttribute(t,r));try{u.save(f)}catch(e){null===i?u.removeAttribute(t):u.setAttribute(t,i),d.userData();try{u.setAttribute(t,r)
,u.save(f)}catch(e){throw null===i?u.removeAttribute(t):u.setAttribute(t,i),d.error()}}return l})}}(),o={},r={},d.addType("memory",function(e,t,n){return e?t===p?i(o[e]):(r[e]&&(clearTimeout(r[e]),delete r[e]),null===t?(delete o[e],null):(o[e]=t,n.expires&&(r[e]=setTimeout(function(){delete o[e],delete r[e]},n.expires)),t)):i(o)})}(this.amplify=this.amplify||{});var Hogan={};!function(e){function u(e,t,n){var o;return t&&"object"==typeof t&&(
void 0!==t[e]?o=t[e]:n&&t.get&&"function"==typeof t.get&&(o=t.get(e))),o}e.Template=function(e,t,n,o){e=e||{},this.r=e.code||this.r,this.c=n,this.options=o||{},this.text=t||"",this.partials=e.partials||{},this.subs=e.subs||{},this.buf=""},e.Template.prototype={r:function(e,t,n){return""},v:function(e){return e=a(e),s.test(e)?e.replace(t,"&amp;").replace(n,"&lt;").replace(o,"&gt;").replace(r,"&#39;").replace(i,"&quot;"):e},t:a,render:function(e,t,n){return this.ri([e],t||{},n)},ri:function(e,t,n
){return this.r(e,t,n)},ep:function(e,t){var n=this.partials[e],o=t[n.name];if(n.instance&&n.base==o)return n.instance;if("string"==typeof o){if(!this.c)throw new Error("No compiler available.");o=this.c.compile(o,this.options)}if(!o)return null;if(this.partials[e].base=o,n.subs){for(key in t.stackText||(t.stackText={}),n.subs)t.stackText[key]||(t.stackText[key]=void 0!==this.activeSub&&t.stackText[this.activeSub]?t.stackText[this.activeSub]:this.text);o=function(e,t,n,o,r,i){function s(){}
function a(){}var l;a.prototype=(s.prototype=e).subs;var c=new s;for(l in c.subs=new a,c.subsText={},c.buf="",o=o||{},c.stackSubs=o,c.subsText=i,t)o[l]||(o[l]=t[l]);for(l in o)c.subs[l]=o[l];for(l in r=r||{},c.stackPartials=r,n)r[l]||(r[l]=n[l]);for(l in r)c.partials[l]=r[l];return c}(o,n.subs,n.partials,this.stackSubs,this.stackPartials,t.stackText)}return this.partials[e].instance=o},rp:function(e,t,n,o){var r=this.ep(e,n);return r?r.ri(t,n,o):""},rs:function(e,t,n){var o=e[e.length-1];if(f(o)
)for(var r=0;r<o.length;r++)e.push(o[r]),n(e,t,this),e.pop();else n(e,t,this)},s:function(e,t,n,o,r,i,s){var a;return(!f(e)||0!==e.length)&&("function"==typeof e&&(e=this.ms(e,t,n,o,r,i,s)),a=!!e,!o&&a&&t&&t.push("object"==typeof e?e:t[t.length-1]),a)},d:function(e,t,n,o){var r,i=e.split("."),s=this.f(i[0],t,n,o),a=this.options.modelGet,l=null;if("."===e&&f(t[t.length-2]))s=t[t.length-1];else for(var c=1;c<i.length;c++)s=void 0!==(r=u(i[c],s,a))?(l=s,r):"";return!(o&&!s)&&(
o||"function"!=typeof s||(t.push(l),s=this.mv(s,t,n),t.pop()),s)},f:function(e,t,n,o){for(var r=!1,i=!1,s=this.options.modelGet,a=t.length-1;0<=a;a--)if(void 0!==(r=u(e,t[a],s))){i=!0;break}return i?(o||"function"!=typeof r||(r=this.mv(r,t,n)),r):!o&&""},ls:function(e,t,n,o,r,i){var s=this.options.delimiters;return this.options.delimiters=i,this.b(this.ct(a(e.call(t,r,n)),t,o)),this.options.delimiters=s,!1},ct:function(e,t,n){if(this.options.disableLambda)throw new Error(
"Lambda features disabled.");return this.c.compile(e,this.options).render(t,n)},b:function(e){this.buf+=e},fl:function(){var e=this.buf;return this.buf="",e},ms:function(e,t,n,o,r,i,s){var a,l=t[t.length-1],c=e.call(l);return"function"==typeof c?!!o||(a=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(c,l,t,n,a.substring(r,i),s)):c},mv:function(e,t,n){var o=t[t.length-1],r=e.call(o);return"function"==typeof r?this.ct(a(r.call(o)),o,n):r
},sub:function(e,t,n,o){var r=this.subs[e];r&&(this.activeSub=e,r(t,n,this,o),this.activeSub=!1)}};var t=/&/g,n=/</g,o=/>/g,r=/\'/g,i=/\"/g,s=/[&<>\"\']/;function a(e){return String(null==e?"":e)}var f=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}}("undefined"!=typeof exports?exports:Hogan),function(a){var l=!!a.XDomainRequest,c="withCredentials"in new XMLHttpRequest||l,u=!1,f={};try{(u=new Worker("js/hnapi-worker.js")).addEventListener("message",
function(e){var t,n,o,r=e.data,i=r.url||"";f[i]&&(n=(t=f[i]).error,o=t.success,delete f[i],r.error?n(r.error):o(r.response))},!1)}catch(e){}function i(t,e,n){var o,r,i,s;e=e||function(){},n=n||function(){},c?u?(f[t]={success:e,error:n},u.postMessage({url:t,timeout:2e4})):((o=f[t]||new(l?XDomainRequest:XMLHttpRequest))._timeout&&clearTimeout(o._timeout),o._timeout=setTimeout(function(){o.abort()},2e4),o.onload=function(){clearTimeout(this._timeout),delete f[t];try{e(JSON.parse(this.responseText))
}catch(e){n(e)}},o.onerror=o.onabort=o.ontimeout=function(e){clearTimeout(this._timeout),delete f[t],n(e)},(o.readyState<=1||l)&&(o.open("GET",t,!0),o.send()),f[t]=o):(i=(r=a.document).createElement("script"),s="callback"+ +new Date,a[s]=e,i.onerror=n,i.src=t+"?callback="+s,r.body.appendChild(i))}var s=["https://node-hnapi-eu.herokuapp.com/","https://node-hnapi.azurewebsites.net/","https://node-hnapi-eus.azurewebsites.net/"];!function(e){for(var t=e.length-1;0<t;t--){var n=Math.floor(
Math.random()*(t+1)),o=e[t];e[t]=e[n],e[n]=o}}(s),s.unshift("https://api.hackerwebapp.com/");function o(e,t,n){i(s[0]+e,t,function(){d(0,e,t,n)})}var p=s.length,d=function(e,t,n,o){var r=e<p-1?function(){d(e+1,t,n,o)}:o;i(s[e]+t,n,r)},e={urls:s,news:function(e,t){o("news",e,t)},news2:function(e,t){o("news2",e,t)},item:function(e,t,n){o("item/"+e,t,n)},comments:function(e,t,n){o("comments/"+e,t,n)}};a.hnapi=e}(window),function(e){function i(e,t){for(var n,o,r,i=!1;n=e,o=t,r=void 0,!(i=((
r=s.documentElement).matchesSelector||r.mozMatchesSelector||r.webkitMatchesSelector||r.oMatchesSelector||r.msMatchesSelector).call(n,o))&&(e=e.parentNode)&&e.ownerDocument;);return!!i&&e}var s=e.document;e.ibento=function(n,e,o){var r=s.body;r.addEventListener(e,function(e){var t=i(e.target,n);t&&o.call(r,e,t)})}}(window),function(e){TEMPLATES={"comments-toggle":new e({code:function(e,t,n){var o=this;return o.b(n=n||""),o.b('<button class="comments-toggle">'),o.b(o.v(o.f("comments_count",e,t,0))
),o.b(" "),o.b(o.v(o.f("i_reply",e,t,0))),o.b("</button>"),o.fl()},partials:{},subs:{}}),comments:new e({code:function(e,t,n){var o=this;return o.b(n=n||""),o.s(o.f("comments",e,t,1),e,t,0,13,418,"{{ }}")&&(o.rs(e,t,function(e,t,n){n.b('<li><p class="metadata '),n.s(n.f("deleted",e,t,1),e,t,0,48,55,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b("deleted")}),e.pop()),n.b('">'),n.s(n.f("deleted",e,t,1),e,t,0,81,103,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b("<span>[deleted]</span>")}),e.pop()),n.s(n.f(
"deleted",e,t,1),e,t,1,0,0,"")||(n.b('<a href="https://news.ycombinator.com/user?id='),n.b(n.v(n.f("user",e,t,0))),n.b('" target="_blank"><b class="user">'),n.b(n.v(n.f("user",e,t,0))),n.b("</b></a>")),n.b('<time><a href="https://news.ycombinator.com/item?id='),n.b(n.v(n.f("id",e,t,0))),n.b('" target="_blank">'),n.b(n.v(n.f("time_ago",e,t,0))),n.b("</a></time></p>"),n.s(n.f("deleted",e,t,1),e,t,1,0,0,"")||(n.b("<p>"),n.b(n.t(n.f("content",e,t,0))),n.b("<ul>"),n.b(n.rp("<comments_list0",e,t,"")),
n.b("</ul>")),n.b("</li>")}),e.pop()),o.fl()},partials:{"<comments_list0":{name:"comments_list",partials:{},subs:{}}},subs:{}}),"post-comments":new e({code:function(e,t,n){var o=this;return o.b(n=n||""),o.b('<div class="post-content">'),o.s(o.f("has_post",e,t,1),e,t,0,39,573,"{{ }}")&&(o.rs(e,t,function(e,t,n){n.b('<header><a href="'),n.b(n.v(n.f("url",e,t,0))),n.b('" target="_blank"><h1>'),n.b(n.v(n.f("title",e,t,0))),n.b("</h1>"),n.s(n.f("user",e,t,1),e,t,0,108,171,"{{ }}")&&(n.rs(e,t,
function(e,t,n){n.s(n.f("domain",e,t,1),e,t,0,119,160,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b('<span class="link-text">'),n.b(n.v(n.f("domain",e,t,0))),n.b("</span>")}),e.pop())}),e.pop()),n.b('</a><p class="metadata">'),n.s(n.f("user",e,t,1),e,t,0,213,408,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b('<span class="inline-block">'),n.b(n.v(n.f("points",e,t,0))),n.b(" "),n.b(n.v(n.f("i_point",e,t,0))),n.b(" by "),n.b(n.v(n.f("user",e,t,0))),n.b('</span> <span class="inline-block">'),n.b(n.v(n.f(
"time_ago",e,t,0))),n.s(n.f("comments_count",e,t,1),e,t,0,340,382,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b(" &middot; "),n.b(n.v(n.f("comments_count",e,t,0))),n.b(" "),n.b(n.v(n.f("i_comment",e,t,0)))}),e.pop()),n.b("</span>")}),e.pop()),n.s(n.f("user",e,t,1),e,t,1,0,0,"")||(n.b('<span class="inline-block">'),n.b(n.v(n.f("time_ago",e,t,0))),n.b("</span>")),n.b('<a href="'),n.b(n.v(n.f("hn_url",e,t,0))),n.b('" target="_blank" class="external-link">'),n.b(n.v(n.f("short_hn_url",e,t,0))),n.b(
"</a></p></header>")}),e.pop()),o.s(o.f("has_content",e,t,1),e,t,0,602,925,"{{ }}")&&(o.rs(e,t,function(e,t,n){n.b('<section class="grouped-tableview">'),n.b(n.t(n.f("content",e,t,0))),n.s(n.f("has_poll",e,t,1),e,t,0,663,902,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b('<ul class="poll">'),n.s(n.f("poll",e,t,1),e,t,0,689,888,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b('<li title="'),n.b(n.v(n.f("percentage",e,t,0))),n.b('%"><span class="poll-details"><b>'),n.b(n.v(n.f("item",e,t,0))),n.b(
'</b> <span class="points">'),n.b(n.v(n.f("points",e,t,0))),n.b(" "),n.b(n.v(n.f("i_point",e,t,0))),n.b('</span></span><div class="poll-bar"><span style="width: '),n.b(n.v(n.f("width",e,t,0))),n.b('"></span></div></li>')}),e.pop()),n.b("</ul>")}),e.pop()),n.b("</section>")}),e.pop()),o.b('</div><section class="comments">'),o.s(o.f("loading",e,t,1),e,t,0,985,1055,"{{ }}")&&(o.rs(e,t,function(e,t,n){n.b('<div class="loader"><i class="icon-loading"></i> Loading&hellip;</div>')}),e.pop()),o.s(o.f(
"load_error",e,t,1),e,t,0,1082,1165,"{{ }}")&&(o.rs(e,t,function(e,t,n){n.b('<div class="load-error">Couldn\'t load comments.<br><button>Try again</button></div>')}),e.pop()),o.s(o.f("loading",e,t,1),e,t,1,0,0,"")||o.s(o.f("load_error",e,t,1),e,t,1,0,0,"")||(o.s(o.f("has_comments",e,t,1),e,t,0,1224,1251,"{{ }}")&&(o.rs(e,t,function(e,t,n){n.b("<ul>"),n.b(n.rp("<comments_list0",e,t,"")),n.b("</ul>")}),e.pop()),o.s(o.f("has_comments",e,t,1),e,t,1,0,0,"")||o.b(
'<p class="no-comments">No comments.</p>')),o.b("</section>"),o.fl()},partials:{"<comments_list0":{name:"comments_list",partials:{},subs:{}}},subs:{}}),post:new e({code:function(e,t,n){var o=this;return o.b(n=n||""),o.b('<li id="story-'),o.b(o.v(o.f("id",e,t,0))),o.b('" data-index="'),o.b(o.v(o.f("i",e,t,0))),o.b('" class="post-'),o.b(o.v(o.f("type",e,t,0))),o.b('"><a href="'),o.b(o.v(o.f("url",e,t,0))),o.b('" class="'),o.s(o.f("detail_disclosure",e,t,1),e,t,0,110,127,"{{ }}")&&(o.rs(e,t,
function(e,t,n){n.b("detail-disclosure")}),e.pop()),o.s(o.f("disclosure",e,t,1),e,t,0,164,174,"{{ }}")&&(o.rs(e,t,function(e,t,n){n.b("disclosure")}),e.pop()),o.b(" "),o.s(o.f("selected",e,t,1),e,t,0,203,211,"{{ }}")&&(o.rs(e,t,function(e,t,n){n.b("selected")}),e.pop()),o.b('"><div class="number">'),o.b(o.v(o.f("i",e,t,0))),o.b('</div><div class="story"><b>'),o.b(o.v(o.f("title",e,t,0))),o.b("</b>"),o.s(o.f("user",e,t,1),e,t,0,301,585,"{{ }}")&&(o.rs(e,t,function(e,t,n){n.b(
'<div class="metadata">'),n.s(n.f("domain",e,t,1),e,t,0,334,373,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b('<div class="link-text">'),n.b(n.v(n.f("domain",e,t,0))),n.b("</div>")}),e.pop()),n.b('<span class="inline-block">'),n.b(n.v(n.f("points",e,t,0))),n.b(" "),n.b(n.v(n.f("i_point",e,t,0))),n.b(" by "),n.b(n.v(n.f("user",e,t,0))),n.b('</span> <span class="inline-block">'),n.b(n.v(n.f("time_ago",e,t,0))),n.s(n.f("comments_count",e,t,1),e,t,0,511,553,"{{ }}")&&(n.rs(e,t,function(e,t,n){n.b(
" &middot; "),n.b(n.v(n.f("comments_count",e,t,0))),n.b(" "),n.b(n.v(n.f("i_comment",e,t,0)))}),e.pop()),n.b("</span></div>")}),e.pop()),o.s(o.f("user",e,t,1),e,t,1,0,0,"")||(o.b('<div class="metadata">'),o.s(o.f("domain",e,t,1),e,t,0,636,681,"{{ }}")&&(o.rs(e,t,function(e,t,n){n.b('<span class="link-text">'),n.b(n.v(n.f("domain",e,t,0))),n.b("</span><br>")}),e.pop()),o.b('<span class="inline-block">'),o.b(o.v(o.f("time_ago",e,t,0))),o.b("</span></div>")),o.b("</div></a>"),o.s(o.f(
"detail_disclosure",e,t,1),e,t,0,785,859,"{{ }}")&&(o.rs(e,t,function(e,t,n){n.b('<a href="#/item/'),n.b(n.v(n.f("id",e,t,0))),n.b('" class="detail-disclosure-button"><span></span></a>')}),e.pop()),o.b("</li>"),o.fl()},partials:{},subs:{}}),"stories-load":new e({code:function(e,t,n){var o=this;return o.b(n=n||""),o.s(o.f("loading",e,t,1),e,t,0,12,82,"{{ }}")&&(o.rs(e,t,function(e,t,n){n.b('<div class="loader"><i class="icon-loading"></i> Loading&hellip;</div>')}),e.pop()),o.s(o.f("load_error",e,
t,1),e,t,0,109,161,"{{ }}")&&(o.rs(e,t,function(e,t,n){n.b('<div class="load-error">Couldn\'t load stories.</div>')}),e.pop()),o.fl()},partials:{},subs:{}})}}(Hogan.Template),function(e){var w=e.document,f=e.$=function(e){return w.getElementById(e)},i={},_={pub:function(e,t){var n=i[e];if(n)for(var o=0,r=n.length;o<r;o++)n[o].call(this,t)},sub:function(e,t){i[e]||(i[e]=[]),i[e].push(t)},currentView:null,hideAllViews:function(){for(var e=w.querySelectorAll(".view"),t=0,n=e.length;t<n;t++
)e[t].classList.add("hidden")},tmpl:function(e,t){var n=TEMPLATES[e];if(n)return t?n.render(t):n},setTitle:function(e){var t="HackerWeb";e&&(e=e.replace(/^\s+|\s+$/g,"")).toLowerCase()!=t.toLowerCase()&&(t=e+" – "+t),document.title=t}},k=_.tmpl;amplify.store.sessionStorage&&"function"==typeof amplify.store.sessionStorage||(amplify.store.sessionStorage=amplify.store.memory);function S(e){if(r=a[e])return r;s.href=e;var t=s.hostname.replace(/^www\./,""),n=s.pathname.replace(/^\//,"").split("/")[0]
,o=n.length,r=t+(t.length<=25&&3<o&&o<=15&&/^[^0-9][^.]+$/.test(n)?"/"+n:"");return a[e]=r}var s=w.createElement("a"),a={},l=w.querySelector("#view-home .scroll").querySelector("section"),c=!1;_.news={options:{disclosure:!0},markupStory:function(e){return/^item/i.test(e.url)?e.url="#/item/"+e.id:(e.external=!0,e.domain=S(e.url)),_.news.options.disclosure?("link"==e.type&&(e.detail_disclosure=!0),/^#\//.test(e.url)&&(e.detail_disclosure=!1,e.disclosure=!0,e.domain=null)):e.id&&(
e.url="#/item/"+e.id),e.i_point=1==e.points?"point":"points",e.i_comment=1==e.comments_count?"comment":"comments",k("post",e)},markupStories:function(e,t){var n="";t=t||1;var o=_.news.markupStory;return e.forEach(function(e){e.i=t++,n+=o(e)}),n},updateStory:function(e){if(e&&e.id){var n,o,t,r=e.id,i=e.data,s="hacker-news",a=amplify.store(s);if(a)for(var l=0,c=a.length;l<c;l++){if(r==(u=a[l]).id){n=u;break}}if(!n&&(s="hacker-news2",a=amplify.store(s)))for(var u,l=0,c=a.length;l<c;l++){if(r==(
u=a[l]).id){n=u;break}}n&&(o=!1,["title","url","time_ago","comments_count","points"].forEach(function(e){var t=i[e];n[e]!=t&&(n[e]=t,o=!0)}),o&&(amplify.store(s,a),(t=f("story-"+r))&&(n.selected=!!t.querySelector("a[href].selected"),n.i=t.dataset?t.dataset.index:t.getAttribute("data-index"),t.insertAdjacentHTML("afterend",_.news.markupStory(n)),t.parentNode.removeChild(t))))}},render:function(e){var t,n,o,r,i,s;c||(e=e||{},t=amplify.store("hacker-news-cached"),n=k("stories-load"),o=function(e){
var t=e.slice(),n='<ul class="tableview tableview-links" id="hwlist">'+_.news.markupStories(t)+(amplify.store("hacker-news2")?'<li><a class="more-link">More&hellip;<span class="loader"><i class="icon-loading"></i></span></a></li>':"")+"</ul>";l.innerHTML=n,_.pub("onRenderNews")},t?(r=amplify.store("hacker-news"),(i=e.delay)?(c=!0,l.innerHTML=n.render({loading:!0}),setTimeout(function(){c=!1,o(r)},i)):o(r)):(c=!0,l.innerHTML=n.render({loading:!0}),s=function(){l.innerHTML=n.render({load_error:!0}
),_.pub("logAPIError","news")},hnapi.news(function(e){c=!1,e&&!e.error?(amplify.store("hacker-news",e),amplify.store("hacker-news-cached",!0,{expires:6e5}),amplify.store("hacker-news2",null),o(e),hnapi.news2(function(e){e&&!e.error&&(amplify.store("hacker-news2",e),f("hwlist").insertAdjacentHTML("beforeend",'<li><a class="more-link">More&hellip;<span class="loader"></span></a></li>'))})):s()},function(e){c=!1,s()})))},reload:function(){_.news.render({delay:300})},more:function(o){var r
;o.classList.contains("loading")||(o.classList.add("loading"),r=amplify.store("hacker-news2"),setTimeout(function(){o.classList.remove("loading");var e,t,n=o.parentNode;n&&(n.parentNode&&n.parentNode.removeChild(n),r&&(e=r.slice(),t=_.news.markupStories(e,31),f("hwlist").insertAdjacentHTML("beforeend",t)))},400))}};var t=f("view-comments"),x=t.querySelector("header h1"),T=t.querySelector("section");_.comments={currentID:null,render:function(t){if(t){var e=amplify.store.sessionStorage(
"hacker-item-"+t);if(_.comments.currentID!=t||!e){_.comments.currentID=t;function n(e,t){var n=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(e),o=k("post-comments");if(n.has_post=!!n.title,!n.has_post)return _.setTitle(),x.innerText="",T.innerHTML=o.render(n),_.pub("adjustCommentsSection"),void _.pub("onRenderComments");var r,i,s=k("comments");/^item/i.test(n.url)?n.url="//news.ycombinator.com/"+n.url:n.domain=S(n.url),
n.has_comments=n.comments&&!!n.comments.length,n.i_point=1==n.points?"point":"points",n.i_comment=1==n.comments_count?"comment":"comments",n.has_content=!!n.content,n.poll&&(i=r=0,n.poll.forEach(function(e){var t=e.points;i<t&&(i=t),r+=t,e.i_point=1==t?"point":"points"}),n.poll.forEach(function(e){var t=e.points;e.percentage=(t/r*100).toFixed(1),e.width=(t/i*100).toFixed(1)+"%"}),n.has_poll=n.has_content=!0),n.short_hn_url="news.ycombinator.com/item?id="+t,n.hn_url="//"+n.short_hn_url,
_.setTitle(n.title),x.innerText=n.title;var a=o.render(n,{comments_list:s}),l=w.createElement("div");l.innerHTML=a;for(var c=l.querySelectorAll("a"),u=0,f=c.length;u<f;u++){c[u].target="_blank"}var p=n.user;if(p)for(var d=l.querySelectorAll(".user"),u=0,f=d.length;u<f;u++){var m=d[u];m.textContent.trim()==p&&(m.classList.add("op"),m.title="Original Poster")}if(2e4<a.length)for(var h=l.querySelectorAll(".comments>ul>li>ul"),b=k("comments-toggle"),v=0,f=h.length;v<f;v++){var g=h[v],
y=g.querySelectorAll(".metadata").length;g.style.display="none",y&&g.insertAdjacentHTML("beforebegin",b.render({comments_count:y,i_reply:1==y?"reply":"replies"}))}for(;T.hasChildNodes();)T.removeChild(T.childNodes[0]);for(;l.hasChildNodes();)T.appendChild(l.childNodes[0]);delete l,_.pub("onRenderComments")}if(e)T.scrollTop=0,n(e,t);else{var o=amplify.store("hacker-news");if(o)for(var r=0,i=o.length;r<i;r++){var s=o[r];if(t==s.id){e=s;break}}if(!e)if(o=amplify.store("hacker-news2"))for(r=0,
i=o.length;r<i;r++){s=o[r];if(t==s.id){e=s;break}}e?(e.loading=!0,n(e,t)):n({loading:!0},t);function a(){e?(delete e.loading,e.load_error=!0,n(e,t)):n({load_error:!0},t),_.pub("logAPIError","comments")}hnapi.item(t,function(e){_.comments.currentID==t&&(!e||e.error&&"comments"==_.currentView?a():(amplify.store.sessionStorage("hacker-item-"+t,e,{expires:3e5}),_.news.updateStory({id:t,data:e}),n(e,t)))},function(e){_.comments.currentID==t&&a()})}}}},toggle:function(e){var t,n,o=e.nextElementSibling
;o&&(t=o.style,n=T.scrollTop,t.display="none"==t.display?"":"none",T.scrollTop=n)},reload:function(){_.comments.currentID=null,ruto.reload()}},_.init=function(){_.news.render(),ruto.init(),function e(){var t,n,o,r,i,s,a=Array.from(document.styleSheets).find(function(e){return/hw.*\.css/i.test(e.href)});function l(e){"dark"===e?(t.media.mediaText="screen",o.content="dark"):"light"===e?(t.media.mediaText="not all",o.content="light"):(t.media.mediaText="(prefers-color-scheme: dark)",
o.content="dark light")}a?(t=Array.from(a.cssRules).find(function(e){return e.media&&/color-scheme:\s*dark/i.test(e.media.mediaText)}))&&(f("hw-appearance-container").hidden=!1,n=f("hw-appearance"),o=f("meta-color-scheme"),r=window.matchMedia&&"not all"!==window.matchMedia("(prefers-color-scheme)").media,i="hw-appearance",l(s=localStorage.getItem(i)||"auto"),r?(n.querySelector("[name=hw-appearance][value=auto]").parentNode.hidden=!1,n.querySelector("[name=hw-appearance][value="+s+"]").checked=!0
):(/(light|dark)/i.test(s)||(s="light"),n.querySelector('[name=hw-appearance][value="'+s+'"]').checked=!0),n.onclick=function(){var e=n.querySelector("[name=hw-appearance]:checked").value;localStorage.setItem(i,e),l(e)}):setTimeout(e,1e3)}()},e.hw=_,ruto.config({before:function(e,t){_.hideAllViews();var n=f("view-"+t);n.classList.remove("hidden"),_.currentView=t,_.setTitle(n.querySelector("header h1").textContent)},notfound:function(){ruto.go("/")}}).add("/","home").add("/about","about").add(
/^\/item\/(\d+)$/i,"comments",function(e,t){_.comments.render(t)})}(window),function(o){var n,r,e,i,t,s,a,l;o.addEventListener&&((n=o.document).body,r={},i=function(){return o.pageYOffset||"CSS1Compat"===n.compatMode&&n.documentElement.scrollTop||0},t=function(){var e=location.hash.slice(1),t=r[e]=i(),n="hacker-scrolltop-"+e;amplify.store.sessionStorage(n,t)},o.addEventListener("scroll",function(){clearTimeout(e),e=setTimeout(t,500)},!1),ruto.config({on:function(){var e=location.hash.slice(1),
t="hacker-scrolltop-"+e,n=amplify.store.sessionStorage(t);o.scrollTo(0,r[e]||n||0),n=r[e]=i(),amplify.store.sessionStorage(t,n)}}),s=n.head||n.getElementsByTagName("head")[0],a=function(){var e=o.innerHeight,t=$("view-height");t||((t=n.createElement("style")).id="view-height",s.appendChild(t)),788<=o.innerWidth&&(e*=.9),t.textContent=".view>.scroll{min-height: "+e+"px}"},o.addEventListener("resize",a,!1),o.addEventListener("orientationchange",a,!1),a(),ibento("#view-home-refresh","click",
hw.news.reload),ibento("#view-home .more-link","click",function(e,t){hw.news.more(t)}),ibento("button.comments-toggle","click",function(e,t){hw.comments.toggle(t)}),ibento("#view-comments .load-error button","click",hw.comments.reload),/Mobile;.*Firefox/.test(navigator.userAgent)&&navigator.mozApps&&((l=navigator.mozApps.getSelf()).onsuccess=function(){l.result&&ibento('a[href]:not([href^="#"])',"click",function(e,t){e.preventDefault(),window.open(t.href,"browser")})}),window.onload=hw.init)}(
window);
//# sourceMappingURL=hw-web.min.js.map